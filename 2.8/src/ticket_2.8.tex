\include{preamble}

\begin{document}
\ticket{2.8. Контекстно-свободные грамматики. Эффективные методы разбора: LL и LR грамматики. }

\section{LL-грамматики}

\subsection{$FIRST$}

$FIRST(\alpha)$ --- множество терминалов, на которые может начинаться строка, 
выводимая из $\alpha$. И $\varepsilon$, если из нетерминала выводится $\varepsilon$.

Как строить. делаем пока можно:
\begin{enumerate}
\item Если $X$ --- терминал, то $FIRST(X)=\{X\}$.
\item Если $X\rightarrow\varepsilon$, добавить $\varepsilon$ к $FIRST(X)$.
\item Если $X\rightarrow Y_1 Y_2 ... Y_k Z \alpha$ и $\varepsilon\in FIRST(Y_i)$ 
      для всех $Y_i$, то добавить в $FIRST(X)$ все из $FIRST(Z)$.
\end{enumerate}

Теперь для строки: $FIRST(X_1 X_2 ... X_n)$ --- это объединение тех $FIRST(X_i)$,
для которых $\forall j < i : \varepsilon \in FIRST(X_j)$ 

\subsection{$FOLLOW$}

$FOLLOW(A)$ --- множество терминалов, которые могут появиться в строке после $A$. 
И \$ (специальный символ), если может появиться в конце строки.

Как строить. делаем пока можно:
\begin{enumerate}
\item Добавить \$ в $FOLLOW(S)$ ($S$ --- стартовый нетерминал).
\item Если $A\rightarrow\alpha B\beta$, добавить в $FOLLOW(B)$ все из $FIRST(\beta)$ кроме $\varepsilon$.
\item Если $A\rightarrow\alpha B$ или $A\rightarrow\alpha B\beta$ и $\varepsilon\in FIRST(\beta)$, то
      добавить в $FOLLOW(B)$ все из $FOLLOW(A)$.
\end{enumerate}

\subsection{Матрица предиктивного анлиза}

Матрица $M(A,a)$, $A$ --- нетерминал, $a$ --- терминал. Показывает, какую 
продукцию выбрать, если есть нетерминал $A$, а нужно получить строку,
которая начинается с $a$.

Как строить. Добавляем продукцию $A\rightarrow\alpha$ в $M(A, a)$ для всех $a\in FIRST(\alpha)$,
а если $\varepsilon\in FIRST(\alpha)$, то добавляем ее еще и в $M(A, b)$ для всех $a\in FOLLOW(\alpha)$.

Если в каждой ячейке матрицы не более одной продукции, значит грамматика LL(1).

Как разбирать. Смотрим на самый левый нетерминал и на то, что на его месте в разбираемой строке.
Смотрим в матрицу, выбираем нужную продукцию, применяем. Повторять пока не получится.

LL($k$)-грамматика --- это такая грамматика, в которой можно выбрать нужную продукцию,
зная $k$ первых терминалов.

\section{LR-грамматики}

LR-анализатор работает следующим образом. У него есть стек и 
с ним он может делать две вещи: \emph{перенос} --- перенести очередной
элемент разбираемой строки в стек или \emph{свертку} --- взять несколько
элементов с верхушки стека и свернуть их в нетермирал, из которого они 
получились. Чтобы понять, какое из двух действий делать и какую продукцию 
выбрать для свертки, у него есть \emph{состояния}. Состояния также
кладутся в стек, между символами грамматики: $s_0 X_1 s_1 X_2 s_2 ... X_m s_m$.

<<Программа>> для LR-анализатора --- это таблицы $action$ и $goto$.

Алгоритм работы анализатора: 
\begin{algorithm}
\begin{algtab}
    \STATE{Установить $ip$ на начало строки.}
    \WHILE{true}
        \STATE{$s$ --- состояние на вершине стека, $a$ --- символ, на который указывает $ip$.}
        \IF {$action[s, a]$ = "перенос $s'$"}
        \STATE{Поместить в стек $a$, затем $s'$; увеличить $ip$}
        \ENDELSEIF {$action[s, a]$ = "свертка $A\rightarrow\beta$"}
        \STATE{Снять со стека $2|\beta|$ символов.}
        \STATE{Пусть $s'$ --- состояние на вершине стека.}
        \STATE{Поместить в стек $A$, затем $goto[s',A]$}
        \ENDELSEIF {$action[s, a]$ = "допуск"}
        \STATE{\RETURN}
        \ENDELSE
        \STATE{error()}
        \END
    \END
\end{algtab}
\end{algorithm}



\end{document}
